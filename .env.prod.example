# Production baseline for dynamic-mcp
# Keep this file as a template only. Do not commit real secrets.

# Transport and profile
MCP_TRANSPORT=http
MCP_PROFILE=enterprise

# HTTP transport
MCP_HOST=0.0.0.0
MCP_PORT=8788
MCP_PATH=/mcp
MCP_HTTP_SESSION_TTL_SECONDS=900
MCP_HTTP_MAX_REQUEST_BYTES=102400

# Dynamic registry (recommended for multi-instance production)
MCP_DYNAMIC_BACKEND=postgres
MCP_DYNAMIC_PG_URL=postgres://dynamic_mcp:change-me@postgres:5432/dynamic_mcp
MCP_DYNAMIC_PG_SCHEMA=dynamic_mcp
MCP_DYNAMIC_PG_INIT_MAX_ATTEMPTS=20
MCP_DYNAMIC_PG_INIT_BACKOFF_MS=1000
MCP_DYNAMIC_MAX_TOOLS=2000
MCP_DYNAMIC_READ_ONLY=false
MCP_REQUIRE_ADMIN_TOKEN=true
MCP_ADMIN_TOKEN=change-me

# Sandbox execution policy
MCP_SANDBOX_DOCKER_BIN=docker
MCP_SANDBOX_MEMORY_LIMIT=512m
MCP_SANDBOX_CPU_LIMIT=1
MCP_SANDBOX_MAX_DEPENDENCIES=32
MCP_SANDBOX_MAX_OUTPUT_BYTES=200000
MCP_SANDBOX_MAX_TIMEOUT_MS=120000
MCP_SANDBOX_ALLOWED_IMAGES=node:lts-slim
MCP_SANDBOX_BLOCKED_PACKAGES=child_process,node-pty,npm,pm2
MCP_SANDBOX_SESSION_TIMEOUT_SECONDS=1800
MCP_SANDBOX_MAX_SESSIONS=100

# Global execution guard
MCP_TOOL_MAX_CONCURRENCY=16
MCP_TOOL_MAX_CALLS_PER_WINDOW=1000
MCP_TOOL_RATE_WINDOW_MS=60000

# JWT auth for MCP endpoint
MCP_AUTH_MODE=jwt
MCP_AUTH_JWKS_URL=https://issuer.example.com/.well-known/jwks.json
MCP_AUTH_ISSUER=https://issuer.example.com/
MCP_AUTH_AUDIENCE=dynamic-mcp
MCP_AUTH_REQUIRED_SCOPES=mcp.invoke

# Audit logging
MCP_AUDIT_ENABLED=true
MCP_AUDIT_FILE=/data/audit.log
MCP_AUDIT_MAX_EVENT_BYTES=20000
MCP_AUDIT_MAX_FILE_BYTES=10000000
MCP_AUDIT_MAX_FILES=10

# Security note:
# /livez, /readyz, /metrics are intentionally anonymous by default even when JWT is enabled.
# Protect these endpoints with network controls (private networking, ingress policy, or gateway ACLs).
